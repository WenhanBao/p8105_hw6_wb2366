---
title: "p8105_hw6_wb2366"
auther: Wenhan Bao
Date: 2021-11-30
output: github_document
---

```{r}
library(tidyverse)
library(readr)
library(corrplot)
 
```


## Problem1

**Load the dataset, clean and check for missing data**

```{r}
birthweight_df <- read_csv("birthweight.csv") %>%
  mutate(
    babysex = fct_infreq(as.factor(babysex)),
    frace = fct_infreq(as.factor(frace)),
    malform = fct_infreq(as.factor(malform)),
    mrace = fct_infreq(as.factor(mrace))
  )

apply(is.na(birthweight_df), 2, which) ## make sure that there is no missing value
```

**Propose a regression model for birthweight.(Based on the a data-driven model-building)** 

```{r, fig.length = 6}
birthweight_df %>%
  select(-babysex,-frace,-malform,-mrace,-pnumlbw,-pnumsga) %>%
  cor(method = "pearson") %>%
  corrplot(
    method = "color",
    type = "lower",
    tl.col = "Black",
    tl.srt = 45,
    diag = F,
    order = "AOE"
  )
```


